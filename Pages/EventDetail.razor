@page "/events/{Id:int}"

@using Models
@inject Services.IEventService EventService
@inject NavigationManager Nav

<h3>Event Details</h3>

@if (isLoading)
{
    <p>Loading event details...</p>
}
else if (eventItem is null)
{
    <div class="alert alert-warning">
        <p>Event not found.</p>
        <button class="btn btn-secondary" @onclick="GoBack">Back</button>
    </div>
}
else
{
    <div class="event-detail-container">

        <img src="@eventItem.ImageUrl"
             alt="@eventItem.ImageAlt"
             class="event-detail-image" />

        <h2>@eventItem.Name</h2>

        <p><strong>Date:</strong> @eventItem.Date.ToString("dddd, dd MMM yyyy")</p>
        <p><strong>Location:</strong> @eventItem.Location</p>

        @if (!string.IsNullOrWhiteSpace(eventItem.Description))
        {
            <p>@eventItem.Description</p>
        }

        <button class="btn btn-primary">
            Register
        </button>

        <button class="btn btn-secondary ms-2" @onclick="GoBack">
            Back
        </button>
    </div>
}

<style> 
.event-detail-container {
    max-width: 700px;
    margin: 0 auto;
}

.event-detail-image {
    width: 100%;
    max-height: 350px;
    object-fit: cover;
    border-radius: 8px;
    margin-bottom: 1rem;
}

</style>

@code {
    [Parameter] public int Id {get; set; }

    private Event? eventItem;
    private bool isLoading = true;

    protected override async Task OnInitializedAsync()
    {
        eventItem = await EventService.GetEventByIdAsync(Id);
        isLoading = false;
    }

    private void GoBack()
    {
        Nav.NavigateTo("/events");
    }
}
